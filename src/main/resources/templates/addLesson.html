<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Add Lesson</title>
  <link rel="stylesheet" th:href="@{assets/css/add-lesson.css}">
  <style>
    #back-btn{
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 16px;
      margin-right: 10px;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<h1>Add Lesson</h1>

<form
        id="lesson-form"
        role="form"
        method="post"
        th:action="@{/addLesson}"
        th:object="${addLessonForm}"
        enctype="multipart/form-data"
>
  <div id="lesson-container">
    <label for="lesson-title">Lesson Title:</label>
    <input type="text" id="lesson-title" th:field="*{lessonName}" required>

    <label for="lesson-des">Lesson Short Description:</label>
    <input type="text" id="lesson-des" th:field="*{lessonDes}" required>
  </div>
  <div id="materials-container">
    <label>Learning Materials:</label>
    <div class="material-row">
      <select class="material-type" id="createMaterialForm" required>
        <option value="">Select Type</option>
        <option value="link" id="link">Link</option>
        <option value="file" id="uploadFile">File</option>
      </select>
    </div>
    <div>
      <div id="form-container-forMaterial"></div>
      <div id="material-type"></div>
    </div>
    <input type="text" class="material-value" placeholder="Material name" th:field="*{learningMaterialName}" required>
  </div>

  <div id="buttons-container">
    <button type="submit" id="submit-btn" value="Submit" name="submit">Continue To Add Quiz</button>
    <button type="button" id="cancel-btn"><a th:href="@{/allCourses}" style="color: white; text-decoration: none">Cancel</a></button>
    <button type="button" id="back-btn"><a th:href="@{/addCourse}" style="color: white; text-decoration: none">Back to course editor</a></button>
  </div>
</form>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Initialize material  form elements
    const createMaterialForm = document.getElementById("createMaterialForm");

    // Add event listener to the "Add Material" option
    createMaterialForm.addEventListener("change", function () {
      createMaForm();
    });

    function createMaForm(){
      const inputType = document.getElementById("createMaterialForm").value;
      const formContainer = document.getElementById("form-container-forMaterial");
      const existingInput = formContainer.querySelector("input");

      // Remove the existing input element if it exists
      if (existingInput) {
        existingInput.parentNode.removeChild(existingInput);
        if(inputType == "link"){
          createLinkForm()
        }else if(inputType == "file"){
          createFileForm()
        }
      }else {
        if(inputType == "link"){
          createLinkForm()
        }else if(inputType == "file"){
          createFileForm()
        }
        const typeInput = document.createElement("select");
        typeInput.classList.add("material-type");
        typeInput.name = "InputType";
        typeInput.required = true;

        const option1 = document.createElement("option");
        option1.value = "youtube";
        option1.label = "Youtube link video";

        const option2 = document.createElement("option");
        option2.value = "pdfLink";
        option2.label = "PDF link";

        const option3 = document.createElement("option");
        option3.value = "fileVideo";
        option3.label = "Video file";

        const option4 = document.createElement("option");
        option4.value = "filePdf";
        option4.label = "PDF file";

        // Append the link form elements to the container in the page
        const materialType = document.getElementById("material-type");
        materialType.appendChild(typeInput);
        typeInput.appendChild(option1);
        typeInput.appendChild(option2);
        typeInput.appendChild(option3);
        typeInput.appendChild(option4);

      }
    }

    function createLinkForm(){
      const linkForm = document.createElement("div");
      linkForm.classList.add("link-form");

        const linkTitleInput = document.createElement("input");
        linkTitleInput.classList.add("link-title");
        linkTitleInput.name = "Input";
        linkTitleInput.setAttribute("type", "text");
        linkTitleInput.placeholder = "Link Title";
        linkTitleInput.required = true;


      // Append the link form elements to the container in the page
      const formContainer = document.getElementById("form-container-forMaterial");
      formContainer.appendChild(linkForm);
      linkForm.appendChild(linkTitleInput);
    }

    function createFileForm(){
      const fileForm = document.createElement("div");
        fileForm.classList.add("file-form");

        const fileTitleInput = document.createElement("input");
        fileTitleInput.classList.add("file-title");
        fileTitleInput.name = "Input";
        fileTitleInput.setAttribute("type", "file");
        fileTitleInput.placeholder = "File Title";
        fileTitleInput.required = true;

      // Append the file form elements to the container in the page
      const formContainer = document.getElementById("form-container-forMaterial");
      formContainer.appendChild(fileForm);
      fileForm.appendChild(fileTitleInput);
    }
  });

</script>
</body>
</html>
